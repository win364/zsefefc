<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CAVEMINES - Balance Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #000; color: #fff; }
        .balance { font-size: 32px; color: #ff6b6b; margin: 20px 0; text-align: center; }
        .test { margin: 10px 0; padding: 10px; border: 1px solid #333; }
        .success { border-color: #0f0; }
        .error { border-color: #f00; }
        button { padding: 10px 20px; margin: 5px; background: #ff6b6b; color: white; border: none; cursor: pointer; }
    </style>
</head>
<body>
    <h1>üéÆ CAVEMINES - Balance Test</h1>
    
    <div class="balance" id="balance">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    
    <div>
        <button onclick="testAPI()">–¢–µ—Å—Ç API</button>
        <button onclick="testSettings()">–¢–µ—Å—Ç –ù–∞—Å—Ç—Ä–æ–µ–∫</button>
        <button onclick="testSession()">–¢–µ—Å—Ç –°–µ—Å—Å–∏–∏</button>
    </div>
    
    <div id="results"></div>
    
    <script>
        const balance = document.getElementById('balance');
        const results = document.getElementById('results');
        
        function addResult(message, success = true) {
            const div = document.createElement('div');
            div.className = `test ${success ? 'success' : 'error'}`;
            div.innerHTML = message;
            results.appendChild(div);
        }
        
        function testAPI() {
            results.innerHTML = '';
            addResult('–¢–µ—Å—Ç–∏—Ä—É–µ–º API...');
            
            fetch('/mines/user')
                .then(response => {
                    addResult(`–°—Ç–∞—Ç—É—Å: ${response.status}`);
                    return response.json();
                })
                .then(data => {
                    addResult(`–î–∞–Ω–Ω—ã–µ: ${JSON.stringify(data, null, 2)}`);
                    balance.textContent = `–ë–∞–ª–∞–Ω—Å: ${data.balance} ${data.currency}`;
                })
                .catch(error => {
                    addResult(`–û—à–∏–±–∫–∞: ${error.message}`, false);
                });
        }
        
        function testSettings() {
            fetch('/mines/settings')
                .then(response => response.json())
                .then(data => {
                    addResult(`–ù–∞—Å—Ç—Ä–æ–π–∫–∏: ${data.supportedCurrencies.length} –≤–∞–ª—é—Ç`);
                    addResult(`RUB –ª–∏–º–∏—Ç—ã: ${data.bets.RUB.quickBets.min} - ${data.bets.RUB.quickBets.max}`);
                })
                .catch(error => {
                    addResult(`–û—à–∏–±–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫: ${error.message}`, false);
                });
        }
        
        function testSession() {
            fetch('/mines/session', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ amount: 10, presetValue: 3 })
            })
            .then(response => response.json())
            .then(data => {
                addResult(`–°–µ—Å—Å–∏—è —Å–æ–∑–¥–∞–Ω–∞: ${JSON.stringify(data, null, 2)}`);
                // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Å—Å–∏–∏
                testAPI();
            })
            .catch(error => {
                addResult(`–û—à–∏–±–∫–∞ —Å–µ—Å—Å–∏–∏: ${error.message}`, false);
            });
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ç–µ—Å—Ç–∏—Ä—É–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        testAPI();
    </script>
</body>
</html>
